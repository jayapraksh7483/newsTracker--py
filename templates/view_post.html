<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ post.title }} - News Tracker</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <nav class="navbar">
        <h1 class="logo">News Tracker</h1>
        <div class="nav-links">
            <a href="{{ url_for('index') }}">Home</a>
            {% if current_user.is_authenticated %}
                <a href="{{ url_for('my_posts') }}">My Posts</a>
                {% if current_user.is_admin %}
                    <a href="{{ url_for('admin') }}">Admin</a>
                {% endif %}
                <a href="{{ url_for('add_post') }}">Add News</a>
                <a href="{{ url_for('logout') }}">Logout</a>
            {% else %}
                <a href="{{ url_for('login') }}">Login</a>
                <a href="{{ url_for('register') }}">Register</a>
            {% endif %}
        </div>
    </nav>

    <div class="container">
        <div class="post-full">
            <!-- Media Section at Top -->
            {% if post.media_url and post.media_type %}
            <div class="post-media-full">
                {% if post.media_type == 'image' %}
                    <img src="{{ url_for('static', filename=post.media_url) }}" alt="{{ post.title }}" class="post-image-full">
                {% elif post.media_type == 'video' %}
                    <video controls preload="metadata" playsinline class="post-video-full">
                        <source src="{{ url_for('static', filename=post.media_url) }}" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                {% endif %}
            </div>
            {% endif %}

            <!-- Post Content -->
            <div class="post-content-full">
                <h1 class="post-title-full">{{ post.title }}</h1>
                <div class="post-meta-full">
                    <span class="post-author">Posted by {{ post.user.username }}</span>
                    <span class="post-date">{{ post.date_posted.strftime('%Y-%m-%d %H:%M') }}</span>
                    <span class="post-location">{{ post.city }}</span>
                    <span class="post-category">{{ post.category }}</span>
                </div>
                
                <div class="post-description-full">
                    {{ post.description }}
                </div>

                {% if post.url %}
                <div class="post-external-link">
                    <a href="{{ post.url }}" target="_blank" class="external-link-btn">Read Full Article</a>
                </div>
                {% endif %}

                <!-- Like and Comment Actions -->
                {% if current_user.is_authenticated %}
                <div class="post-actions-full">
                    <div class="like-section">
                        <button class="like-btn {% if user_liked %}liked{% endif %}" 
                                onclick="likePost({{ post.id }})" 
                                data-post-id="{{ post.id }}">
                            <span class="like-icon">{% if user_liked %}‚ù§Ô∏è{% else %}ü§ç{% endif %}</span>
                            <span class="like-count">{{ post.likes }}</span>
                        </button>
                    </div>
                    
                    <div class="comment-section">
                        <h3>Comments ({{ post.comments|length }})</h3>
                        <p class="comment-info">Share your thoughts! You can comment as many times as you want.</p>
                        <form action="{{ url_for('add_comment', post_id=post.id) }}" method="POST" class="comment-form-full">
                            <textarea name="comment" placeholder="Write a comment..." required class="comment-input-full"></textarea>
                            <button type="submit" class="comment-submit-btn">Post Comment</button>
                        </form>
                    </div>
                </div>
                {% endif %}
            </div>

            <!-- Comments Display -->
            <div class="comments-section">
                <h3>Comments</h3>
                <div class="comments-container">
                    {% if post.comments %}
                        {% for comment in post.comments|sort(attribute='date_posted', reverse=True) %}
                        <div class="comment-item">
                            <div class="comment-header">
                                <span class="comment-author">{{ comment.user.username }}</span>
                                <span class="comment-date">{{ comment.date_posted.strftime('%Y-%m-%d %H:%M') }}</span>
                                {% if current_user.is_authenticated and (current_user.id == comment.user_id or current_user.is_admin) %}
                                <form action="{{ url_for('delete_comment', comment_id=comment.id) }}" method="POST" style="display: inline;">
                                    <button type="submit" class="comment-delete-btn" onclick="return confirm('Are you sure you want to delete this comment?')">üóëÔ∏è</button>
                                </form>
                                {% endif %}
                            </div>
                            <div class="comment-content">{{ comment.content }}</div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <p class="no-comments">No comments yet. Be the first to comment!</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
